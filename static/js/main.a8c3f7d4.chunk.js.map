{"version":3,"sources":["utils.js","components/FadeIn.js","components/GlslCanvas.js","components/GlslModal.js","components/Thumbnail.js","components/GalleryItem.js","components/gallery/GameOfLife.js","components/gallery/ColorAutomata.js","stats.js","App.js","loader.js","index.js"],"names":["createProgram","gl","vertexShader","fragmentShader","program","attachShader","linkProgram","getProgramParameter","LINK_STATUS","console","error","getProgramInfoLog","createShader","type","src","s","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","randomImage","_ref","min","max","width","height","buffer","i","Math","floor","random","Uint8Array","blankImage","_ref2","fill","length","createTexture","textureUnit","image","_ref3","texture","activeTexture","bindTexture","TEXTURE_2D","texImage2D","RGB","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","generateMipmap","FadeIn","children","react_default","a","createElement","react_addons_css_transition_group_default","transitionName","transitionAppear","transitionAppearTimeout","transitionEnter","transitionLeave","GlslCanvas","_React$Component","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","canvasRef","React","createRef","inherits","createClass","key","value","canvas","current","code","_this$props$display","display","glslCanvas","webglCanvas","load","style","initCanvas","_this$props$display2","_this$props$code","FadeIn_FadeIn","data-fragment","data-vertex","ref","Component","defaultProps","textures","GlslModal","apply","arguments","onClick","fullscreen","window","innerHeight","modalProps","assign","cssClasses","classNames","className","GlslCanvas_GlslCanvas","Thumbnail","imgSrc","name","alt","GalleryItem","handleClick","e","log","state","setState","active","handleMouseEnter","handleMouseLeave","_this$props","preview","full","_this$state","author","attribution","item","onMouseEnter","onMouseLeave","Thumbnail_Thumbnail","GlslModal_GlslModal","GameOfLife","_this2","img","Image","promise","Promise","resolve","reject","onload","loadImage","then","startStateImg","animate","createGameOfLife","requestAnimationFrame","step","time","animationFrameReq","timeEnd","cancelAnimationFrame","imageRendering","canvasEl","getContext","VERTEX_SHADER","fragShaderDisplay","FRAGMENT_SHADER","displayShader","fragShaderStepper","stepShader","displayProg","stepperProg","useProgram","stepperProgCoordLoc","getAttribLocation","stepperProgPreviousStateLoc","getUniformLocation","displayProgStateLoc","displayProgSizeLoc","vertexBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","vertexAttribPointer","FLOAT","elementBuffer","ELEMENT_ARRAY_BUFFER","texture0","TEXTURE0","texture1","framebuffers","createFramebuffer","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","nextStateIndex","previousStateIndex","enableVertexAttribArray","uniform1i","drawElements","TRIANGLE_FAN","uniform2f","ColorAutomata","nextFrame","createColorAutomata","_this$props2","concat","reqId","Automata","frameBuffers","seed","idx","push","frameBuffer","id","Error","gpgpu","options","shaderCode","uniformDefinitions","createVertexShader","coordLoc","mappedUniforms","_","mapValues","loc","uniforms","forOwn","toConsumableArray","updateVelocity","velocityShader","velocityAverage","positionAverage","separation","size","updatePosition","positionShader","previousPosition","currentVelocity","invertVelocity","invertVelocityShader","positionTex","velocityTex","neighborAverage","neighborAverageShader","tex","separationShader","automata","performance","now","swap","App","shaders","GalleryItem_GalleryItem","GameOfLife_GameOfLife","ColorAutomata_ColorAutomata","makeStats","stats","Stats","shaderVariants","automataShaders","map","path","variant","reduce","acc","promises","frag","fetch","response","text","responseText","defineProperty","enabled","document","body","appendChild","dom","right","left","loop","update","undefined","removeChild","showFpsCounter","all","responses","utils","keys","forEach","replace","ReactDOM","render","src_App","getElementById"],"mappings":"yPAaaA,EAAgB,SAACC,EAAIC,EAAcC,GAC9C,IAAMC,EAAUH,EAAGD,gBAOnB,OANAC,EAAGI,aAAaD,EAASF,GACzBD,EAAGI,aAAaD,EAASD,GACzBF,EAAGK,YAAYF,GACVH,EAAGM,oBAAoBH,EAASH,EAAGO,cACtCC,QAAQC,MAAM,wBAAyBT,EAAGU,kBAAkBP,IAEvDA,GAGIQ,EAAe,SAACX,EAAIY,EAAMC,GACrC,IAAMC,EAAId,EAAGW,aAAaC,GAW1B,OAVAZ,EAAGe,aAAaD,EAAGD,GACnBb,EAAGgB,cAAcF,GACZd,EAAGiB,mBAAmBH,EAAGd,EAAGkB,iBAC/BV,QAAQC,MACN,2BACAG,EACAC,EACAb,EAAGmB,iBAAiBL,IAGjBA,GAMF,IAAMM,EAAc,SAAAC,GAEzB,IAFgD,IAH/BC,EAAKC,EAGMC,EAAoBH,EAApBG,MAAOC,EAAaJ,EAAbI,OAC/BC,EAAS,GACJC,EAAI,EAAGA,EAAIH,EAAQC,EAAS,EAAGE,IACtCD,EAAOC,IANQL,EAMO,EANFC,EAMK,IALpBK,KAAKC,MAAMD,KAAKE,UAAYP,EAAMD,EAAM,IAAMA,GAOrD,OAAO,IAAIS,WAAWL,IAEXM,EAAa,SAAAC,GAAuB,IAApBT,EAAoBS,EAApBT,MAAOC,EAAaQ,EAAbR,OAC9BC,EAAS,IAAIK,WAAW,EAAIP,EAAQC,GAExC,OADAC,EAAOQ,KAAK,EAAG,EAAGR,EAAOS,QAClBT,GAcIU,EAAgB,SAACpC,EAAIqC,EAAaC,EAAlBC,GAA+C,IAApBf,EAAoBe,EAApBf,MAAOC,EAAac,EAAbd,OACvDe,EAAUxC,EAAGoC,gBAiBnB,OAhBApC,EAAGyC,cAAcJ,GACjBrC,EAAG0C,YAAY1C,EAAG2C,WAAYH,GAC9BxC,EAAG4C,WACD5C,EAAG2C,WACH,EACA3C,EAAG6C,IACHrB,EACAC,EACA,EACAzB,EAAG6C,IACH7C,EAAG8C,cACHR,GAEFtC,EAAG+C,cAAc/C,EAAG2C,WAAY3C,EAAGgD,mBAAoBhD,EAAGiD,SAC1DjD,EAAG+C,cAAc/C,EAAG2C,WAAY3C,EAAGkD,mBAAoBlD,EAAGiD,SAC1DjD,EAAGmD,eAAenD,EAAG2C,YACdH,oBCjFIY,EAAS,SAAA/B,GAAA,IAAGgC,EAAHhC,EAAGgC,SAAH,OACpBC,EAAAC,EAAAC,cAACC,EAAAF,EAAD,CACEG,eAAe,OACfC,kBAAkB,EAClBC,wBAAyB,IACzBC,iBAAiB,EACjBC,iBAAiB,GAEhBT,ICJQU,EAAb,SAAAC,GACE,SAAAD,EAAYE,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAN,IACjBG,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAJ,GAAAS,KAAAH,KAAMJ,KAEDQ,UAAYC,IAAMC,YAHNT,EADrB,OAAAC,OAAAS,EAAA,EAAAT,CAAAJ,EAAAC,GAAAG,OAAAU,EAAA,EAAAV,CAAAJ,EAAA,EAAAe,IAAA,aAAAC,MAAA,WAQI,IAAMC,EAASX,KAAKI,UAAUQ,QACtB/E,EAAmBmE,KAAKJ,MAAMiB,KAA9BhF,eAFGiF,EAGed,KAAKJ,MAAMmB,QAA7B5D,EAHG2D,EAGH3D,MAAOC,EAHJ0D,EAGI1D,OACf4C,KAAKgB,WAAa,IAAIC,IAAYN,GAClCX,KAAKgB,WAAWE,KAAKrF,GACrB8E,EAAOQ,MAAMhE,MAAQA,EACrBwD,EAAOQ,MAAM/D,OAASA,IAd1B,CAAAqD,IAAA,oBAAAC,MAAA,WAkBIV,KAAKoB,eAlBT,CAAAX,IAAA,SAAAC,MAAA,WAqBW,IAAAW,EACmBrB,KAAKJ,MAAMmB,QAA7B5D,EADDkE,EACClE,MAAOC,EADRiE,EACQjE,OADRkE,EAEkCtB,KAAKJ,MAAMiB,KAA5ChF,EAFDyF,EAECzF,eAAgBD,EAFjB0F,EAEiB1F,aACxB,OACEqD,EAAAC,EAAAC,cAACoC,EAAD,KACEtC,EAAAC,EAAAC,cAAA,UACEhC,MAAOA,EACPC,OAAQA,EACRoE,gBAAe3F,EACf4F,cAAa7F,EACb8F,IAAK1B,KAAKI,iBA/BpBV,EAAA,CAAgCW,IAAMsB,WA4CtCjC,EAAWkC,aAAe,CACxBf,KAAM,CACJjF,aFrD8B,sOEsD9BiG,SAAU,0BCjDDC,EAAb,SAAAnC,GAAA,SAAAmC,IAAA,OAAAhC,OAAAC,EAAA,EAAAD,CAAAE,KAAA8B,GAAAhC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAgC,GAAAC,MAAA/B,KAAAgC,YAAA,OAAAlC,OAAAS,EAAA,EAAAT,CAAAgC,EAAAnC,GAAAG,OAAAU,EAAA,EAAAV,CAAAgC,EAAA,EAAArB,IAAA,SAAAC,MAAA,WACW,IACCuB,EAAYjC,KAAKJ,MAAjBqC,QACAC,EAAelC,KAAKJ,MAAMmB,QAA1BmB,WACFnB,EAAU,GACG,WAAfmB,GACFnB,EAAQ5D,MAAQgF,OAAOC,YAAc,IAAM,KAC3CrB,EAAQ3D,OAAS+E,OAAOC,YAAc,IAAM,MACpB,SAAfF,IACTnB,EAAQ5D,MAAQ,OAChB4D,EAAQ3D,OAAS,QAEnB,IAAMiF,EAAavC,OAAOwC,OAAO,GAAItC,KAAKJ,MAAO,CAAEmB,YAC7CwB,EAAaC,IAAW,gBAAiBN,GAC/C,OACEjD,EAAAC,EAAAC,cAAA,OAAKsD,UAAWF,EAAYN,QAASA,GACnChD,EAAAC,EAAAC,cAACuD,EAAeL,QAhBxBP,EAAA,CAA+BzB,IAAMsB,WCDxBgB,EAAY,SAAA3F,GAAA,IAAG4F,EAAH5F,EAAG4F,OAAQC,EAAX7F,EAAW6F,KAAM1F,EAAjBH,EAAiBG,MAAOC,EAAxBJ,EAAwBI,OAAxB,OACvB6B,EAAAC,EAAAC,cAACoC,EAAD,KACEtC,EAAAC,EAAAC,cAAA,OAAK3C,IAAKoG,EAAQE,IAAKD,EAAM1F,MAAOA,EAAOC,OAAQA,MCA1C2F,EAAb,SAAApD,GACE,SAAAoD,EAAYnD,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAA+C,IACjBlD,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAiD,GAAA5C,KAAAH,KAAMJ,KAKRoD,YAAc,SAAAC,GACZ9G,QAAQ+G,IAAI,QAASrD,EAAKsD,OADT,IAETjB,EAAerC,EAAKsD,MAApBjB,WACRrC,EAAKuD,SAAS,CAAElB,YAAaA,EAAYmB,QAAQ,KAThCxD,EAYnByD,iBAAmB,SAAAL,GACjB9G,QAAQ+G,IAAI,SACZrD,EAAKuD,SAAS,CAAEC,QAAQ,KAdPxD,EAiBnB0D,iBAAmB,SAAAN,GACjB9G,QAAQ+G,IAAI,SACZrD,EAAKuD,SAAS,CAAEC,QAAQ,KAhBxBxD,EAAKsD,MAAQ,CAAEE,QAAQ,GAHNxD,EADrB,OAAAC,OAAAS,EAAA,EAAAT,CAAAiD,EAAApD,GAAAG,OAAAU,EAAA,EAAAV,CAAAiD,EAAA,EAAAtC,IAAA,SAAAC,MAAA,WAuBW,IAAA8C,EACiCxD,KAAKJ,MAArCiD,EADDW,EACCX,KAAMD,EADPY,EACOZ,OAAQa,EADfD,EACeC,QAASC,EADxBF,EACwBE,KADxB5C,EAEmBd,KAAKJ,MAAMmB,QAA7B5D,EAFD2D,EAEC3D,MAAOC,EAFR0D,EAEQ1D,OAFRuG,EAGwB3D,KAAKmD,MAA5BE,EAHDM,EAGCN,OAAQnB,EAHTyB,EAGSzB,WACR0B,EAAW5D,KAAKJ,MAAMiE,YAAtBD,OACFE,EACJ7E,EAAAC,EAAAC,cAAA,OACEsD,UAAU,eACVtF,MAAOA,EACPC,OAAQA,EACR6E,QAASjC,KAAKgD,YACde,aAAc/D,KAAKsD,iBACnBU,aAAchE,KAAKuD,kBAElBF,EACCI,EAAQzD,KAAKJ,OAEbX,EAAAC,EAAAC,cAAC8E,EAAD,CACErB,OAAQA,EACRC,KAAMA,EACN1F,MAAOA,EACPC,OAAQA,IAGZ6B,EAAAC,EAAAC,cAAA,OAAKsD,UAAU,WACbxD,EAAAC,EAAAC,cAAA,KAAGsD,UAAU,gBAAgBmB,GAC7B3E,EAAAC,EAAAC,cAAA,KAAGsD,UAAU,eAAeI,KAIlC,OAAOX,EACLjD,EAAAC,EAAAC,cAAA,YACGuE,EAAK1D,KAAKJ,MAAOI,KAAKgD,aACtBc,GAGHA,MA3DNf,EAAA,CAAiC1C,IAAMsB,WAgFvCoB,EAAYnB,aAAe,CACzBb,QAAS,CACP5D,MAAO,QACPC,OAAQ,QACR8E,WAAY,UAEd2B,YAAa,GACbJ,QAAS,SAAA7D,GAAK,OAAIX,EAAAC,EAAAC,cAACuD,EAAe9C,IAClC8D,KAAM,SAAC9D,EAAOqC,GAAR,OAAoBhD,EAAAC,EAAAC,cAAC+E,EAADpE,OAAAwC,OAAA,GAAe1C,EAAf,CAAsBqC,QAASA,OC3FpD,IAAMkC,EAAb,SAAAxE,GACE,SAAAwE,EAAYvE,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAmE,IACjBtE,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAqE,GAAAhE,KAAAH,KAAMJ,KAEDQ,UAAYC,IAAMC,YAHNT,EADrB,OAAAC,OAAAS,EAAA,EAAAT,CAAAqE,EAAAxE,GAAAG,OAAAU,EAAA,EAAAV,CAAAqE,EAAA,EAAA1D,IAAA,oBAAAC,MAAA,WAOsB,IAAA0D,EAAApE,KACVa,EAASb,KAAKJ,MAAdiB,KACFF,EAASX,KAAKI,UAAUQ,SN2CT,SAAApE,GACvB,IAAM6H,EAAM,IAAIC,MACVC,EAAU,IAAIC,QAAQ,SAACC,EAASC,GACpCL,EAAIM,OAAS,WACXF,EAAQJ,MAIZ,OADAA,EAAI7H,IAAMA,EACH+H,GMlDLK,CAAU,qCAAqCC,KAAK,SAAAC,GAAiB,IAC3DC,EAAYC,EAAiBrE,EAAQE,EAAMiE,GAA3CC,QAORE,sBANa,SAAPC,IACJ/I,QAAQgJ,KAAK,QACbJ,IACAX,EAAKgB,kBAAoBH,sBAAsBC,GAC/C/I,QAAQkJ,QAAQ,cAhBxB,CAAA5E,IAAA,uBAAAC,MAAA,WAuBIvE,QAAQ+G,IAAI,oCAAqClD,KAAKoF,mBACtDE,qBAAqBtF,KAAKoF,qBAxB9B,CAAA3E,IAAA,SAAAC,MAAA,WA2BW,IAAAY,EACkCtB,KAAKJ,MAAMiB,KAA5ChF,EADDyF,EACCzF,eAAgBD,EADjB0F,EACiB1F,aACxB,OACEqD,EAAAC,EAAAC,cAAA,UACEhC,MAAM,KACNC,OAAO,KACPoE,gBAAe3F,EACf4F,cAAa7F,EACb8F,IAAK1B,KAAKI,UACVe,MAAO,CAAEhE,MAAO,QAASC,OAAQ,QAASmI,eAAgB,mBApClEpB,EAAA,CAAgC9D,IAAMsB,WA0ChC5D,EAAgB,SAACpC,EAAIyC,EAAeH,GACxC,IAAME,EAAUxC,EAAGoC,gBAOnB,OANApC,EAAGyC,cAAcA,GACjBzC,EAAG0C,YAAY1C,EAAG2C,WAAYH,GAC9BxC,EAAG4C,WAAW5C,EAAG2C,WAAY,EAAG3C,EAAG6C,IAAK7C,EAAG6C,IAAK7C,EAAG8C,cAAeR,GAClEtC,EAAG+C,cAAc/C,EAAG2C,WAAY3C,EAAGgD,mBAAoBhD,EAAGiD,SAC1DjD,EAAG+C,cAAc/C,EAAG2C,WAAY3C,EAAGkD,mBAAoBlD,EAAGiD,SAC1DjD,EAAGmD,eAAenD,EAAG2C,YACdH,GAGH6G,EAAmB,SAACQ,EAAU3E,EAAMiE,GACxC,IAAMnJ,EAAK6J,EAASC,WAAW,SAEzB7J,EAAeU,EACnBX,EACAA,EAAG+J,cACH,kFAEIC,EAAoBrJ,EACxBX,EACAA,EAAGiK,gBACH/E,EAAKgF,eAEDC,EAAoBxJ,EACxBX,EACAA,EAAGiK,gBACH/E,EAAKkF,YAGDC,EAActK,EAAcC,EAAIC,EAAc+J,GAC9CM,EAAcvK,EAAcC,EAAIC,EAAckK,GAEpDnK,EAAGuK,WAAWD,GAEd,IAAME,EAAsBxK,EAAGyK,kBAAkBH,EAAa,SACxDI,EAA8B1K,EAAG2K,mBACrCL,EACA,iBAGIM,EAAsB5K,EAAG2K,mBAAmBN,EAAa,OACzDQ,EAAqB7K,EAAG2K,mBAAmBN,EAAa,QACxDS,EAAe9K,EAAG+K,eACxB/K,EAAGgL,WAAWhL,EAAGiL,aAAcH,GAC/B9K,EAAGkL,WACDlL,EAAGiL,aACH,IAAIE,aAAa,EAAE,GAAI,EAAG,GAAI,EAAG,EAAG,GAAI,EAAG,IAC3CnL,EAAGoL,aAMLpL,EAAGqL,oBAAoBb,EAAqB,EAAGxK,EAAGsL,OAAO,EAAO,EAAG,GAEnE,IAAMC,EAAgBvL,EAAG+K,eACzB/K,EAAGgL,WAAWhL,EAAGwL,qBAAsBD,GACvCvL,EAAGkL,WACDlL,EAAGwL,qBACH,IAAIzJ,WAAW,CAAC,EAAG,EAAG,EAAG,IACzB/B,EAAGoL,aAGL,IAAMK,EAAWrJ,EAAcpC,EAAIA,EAAG0L,SAAUvC,GAC1CwC,EAAWvJ,EAAcpC,EAAIA,EAAG0L,SAAW,EAAGvC,GAE9CyC,EAAe,CAAC5L,EAAG6L,oBAAqB7L,EAAG6L,qBAEjD7L,EAAG8L,gBAAgB9L,EAAG+L,YAAaH,EAAa,IAChD5L,EAAGgM,qBACDhM,EAAG+L,YACH/L,EAAGiM,kBACHjM,EAAG2C,WACH8I,EACA,GAGFzL,EAAG8L,gBAAgB9L,EAAG+L,YAAaH,EAAa,IAChD5L,EAAGgM,qBACDhM,EAAG+L,YACH/L,EAAGiM,kBACHjM,EAAG2C,WACHgJ,EACA,GAGF,IAAIO,EAAiB,EAiBrB,MAAO,CAAE9C,QAhBO,WACd,IAAM+C,EAAqB,EAAID,EAC/BlM,EAAG8L,gBAAgB9L,EAAG+L,YAAaH,EAAaM,IAChDlM,EAAGuK,WAAWD,GACdtK,EAAGoM,wBAAwB5B,GAC3BxK,EAAGqM,UAAU3B,EAA6ByB,GAC1CnM,EAAGsM,aAAatM,EAAGuM,aAAc,EAAGvM,EAAG8C,cAAe,GAEtD9C,EAAG8L,gBAAgB9L,EAAG+L,YAAa,MACnC/L,EAAGuK,WAAWF,GACdrK,EAAGqM,UAAUzB,EAAqBsB,GAClClM,EAAGwM,UAAU3B,EAAoB7K,EAAGgF,OAAOxD,MAAOxB,EAAGgF,OAAOvD,QAC5DzB,EAAGsM,aAAatM,EAAGuM,aAAc,EAAGvM,EAAG8C,cAAe,GAEtDoJ,EAAiBC,6BCxIRM,EAAb,SAAAzI,GACE,SAAAyI,EAAYxI,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAoI,IACjBvI,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAsI,GAAAjI,KAAAH,KAAMJ,KAEDQ,UAAYC,IAAMC,YAHNT,EADrB,OAAAC,OAAAS,EAAA,EAAAT,CAAAsI,EAAAzI,GAAAG,OAAAU,EAAA,EAAAV,CAAAsI,EAAA,EAAA3H,IAAA,oBAAAC,MAAA,WAOsB,IAAA0D,EAAApE,KAAAwD,EACcxD,KAAKJ,MAA7BiB,EADU2C,EACV3C,KAAM1D,EADIqG,EACJrG,MAAOC,EADHoG,EACGpG,OACbiL,EAAcC,EAAoBtI,KAAKI,UAAUQ,QAASC,EAAM,CACtE1D,QACAC,WAFMiL,UAURpD,sBANa,SAAPC,IAEJmD,IACAjE,EAAKgB,kBAAoBH,sBAAsBC,OAhBrD,CAAAzE,IAAA,uBAAAC,MAAA,WAwBI4E,qBAAqBtF,KAAKoF,qBAxB9B,CAAA3E,IAAA,SAAAC,MAAA,WA2BW,IAAA6H,EACmBvI,KAAKJ,MAAvBzC,EADDoL,EACCpL,MAAOC,EADRmL,EACQnL,OACf,OACE6B,EAAAC,EAAAC,cAAA,UACEhC,MAAOA,EACPC,OAAQA,EACRsE,IAAK1B,KAAKI,UACVe,MAAO,CAAEhE,MAAK,GAAAqL,OAAKrL,EAAL,MAAgBC,OAAM,GAAAoL,OAAKpL,EAAL,aAlC5CgL,EAAA,CAAmC/H,IAAMsB,WAwCzCyG,EAAcxG,aAAe,CAC3BzE,MAAO,IACPC,OAAQ,SC5CNqL,ED+CEC,aACJ,SAAAA,EAAY/M,EAAZqB,GAAmC,IAAjBG,EAAiBH,EAAjBG,MAAOC,EAAUJ,EAAVI,OAAU0C,OAAAC,EAAA,EAAAD,CAAAE,KAAA0I,GACjC1I,KAAKqD,OAAS,EACdrD,KAAK2I,aAAe,GAEpB,IADA,IAAMC,EAAO7L,EAAY,CAAEI,QAAOC,WACzByL,EAAM,EAAGA,EAAM,EAAGA,IAAO,CAChC,IAAM5K,EAAQ4K,EAAM,EAAID,EAAOjL,EAAW,CAAER,QAAOC,WAC7Ce,EAAUJ,EAAcpC,EAAIA,EAAE,UAAA6M,OAAWK,IAAQ5K,EAAO,CAC5Dd,QACAC,WAEIC,EAAS1B,EAAG6L,oBAClB7L,EAAG8L,gBAAgB9L,EAAG+L,YAAarK,GACnC1B,EAAGgM,qBACDhM,EAAG+L,YACH/L,EAAGiM,kBACHjM,EAAG2C,WACHH,EACA,GAEF6B,KAAK2I,aAAaG,KAAK,CAAE9K,YAAa6K,EAAKE,YAAa1L,wDAK1D2C,KAAKqD,OAAS,EAAIrD,KAAKqD,2CAGb2F,GACV,OAAQA,GACN,IAAK,eACH,OAAOhJ,KAAKqD,OAAS,EAAI,EAC3B,IAAK,eACH,OAAO,EACT,IAAK,eACH,OAAOrD,KAAKqD,OAAS,EAAI,EAC3B,IAAK,eACH,OAAO,EACT,IAAK,kBACH,OAAO,EACT,IAAK,kBACH,OAAO,EACT,IAAK,aACH,OAAO,EACT,QACE,MAAM,IAAI4F,MAAM,0DAIVD,GACV,OAAOhJ,KAAK2I,aAAa3I,KAAKhC,YAAYgL,IAAKD,qBAY7CG,EAAQ,SAACvN,EAAIwN,GAAY,IACrBC,EAAmCD,EAAnCC,WAAYC,EAAuBF,EAAvBE,mBACdzN,EAVmB,SAAAD,GACzB,OAAOW,EACLX,EACAA,EAAG+J,cACH,kFAMmB4D,CAAmB3N,GAClCE,EAAiBS,EAAaX,EAAIA,EAAGiK,gBAAiBwD,GACtDtN,EAAUJ,EAAcC,EAAIC,EAAcC,GAC1C0N,EAAW5N,EAAGyK,kBAAkBtK,EAAS,SAEzC2K,EAAe9K,EAAG+K,eACxB/K,EAAGgL,WAAWhL,EAAGiL,aAAcH,GAC/B9K,EAAGkL,WACDlL,EAAGiL,aACH,IAAIE,aAAa,EAAE,GAAI,EAAG,GAAI,EAAG,EAAG,GAAI,EAAG,IAC3CnL,EAAGoL,aAMLpL,EAAGqL,oBAAoBuC,EAAU,EAAG5N,EAAGsL,OAAO,EAAO,EAAG,GAExD,IAAMC,EAAgBvL,EAAG+K,eACzB/K,EAAGgL,WAAWhL,EAAGwL,qBAAsBD,GACvCvL,EAAGkL,WACDlL,EAAGwL,qBACH,IAAIzJ,WAAW,CAAC,EAAG,EAAG,EAAG,IACzB/B,EAAGoL,aAGL,IAAMyC,EAAiBC,IAAEC,UAAUL,EAAoB,SAACzJ,EAAOiD,GAAR,OACrD/C,OAAOwC,OAAO1C,EAAO,CAAE+J,IAAKhO,EAAG2K,mBAAmBxK,EAAS+G,OAG7D,OAAO,SAACkG,EAAaa,GACnBjO,EAAG8L,gBAAgB9L,EAAG+L,YAAaqB,GACnCpN,EAAGuK,WAAWpK,GACdH,EAAGoM,wBAAwBwB,GAC3BE,IAAEI,OAAOL,EAAgB,SAAC5J,EAAOiD,GAC/BlH,EAAGiE,EAAMrD,MAATwF,MAAApG,EAAE,CAAaiE,EAAM+J,KAAnBnB,OAAA1I,OAAAgK,EAAA,EAAAhK,CAA2B8J,EAAS/G,QAExClH,EAAGsM,aAAatM,EAAGuM,aAAc,EAAGvM,EAAG8C,cAAe,KAIpD6J,EAAsB,SAAC9C,EAAU3E,EAAXjD,GAAuC,IAApBT,EAAoBS,EAApBT,MAAOC,EAAaQ,EAAbR,OAC9CzB,EAAK6J,EAASC,WAAW,SAEzBsE,EAAiBb,EAAMvN,EAAI,CAC/ByN,WAAYvI,EAAKmJ,eACjBX,mBAAoB,CAClBY,gBAAiB,CAAE1N,KAAM,aACzB2N,gBAAiB,CAAE3N,KAAM,aACzB4N,WAAY,CAAE5N,KAAM,aACpB6N,KAAM,CAAE7N,KAAM,aACd4I,KAAM,CAAE5I,KAAM,gBAIZ8N,EAAiBnB,EAAMvN,EAAI,CAC/ByN,WAAYvI,EAAKyJ,eACjBjB,mBAAoB,CAClBkB,iBAAkB,CAAEhO,KAAM,aAC1BiO,gBAAiB,CAAEjO,KAAM,aACzB6N,KAAM,CAAE7N,KAAM,gBAIZkO,EAAiBvB,EAAMvN,EAAI,CAC/ByN,WAAYvI,EAAK6J,qBACjBrB,mBAAoB,CAClBsB,YAAa,CAAEpO,KAAM,aACrBqO,YAAa,CAAErO,KAAM,aACrB6N,KAAM,CAAE7N,KAAM,gBAIZsO,EAAkB3B,EAAMvN,EAAI,CAChCyN,WAAYvI,EAAKiK,sBACjBzB,mBAAoB,CAClB0B,IAAK,CAAExO,KAAM,aACb6N,KAAM,CAAE7N,KAAM,gBAIZ4N,EAAajB,EAAMvN,EAAI,CAC3ByN,WAAYvI,EAAKmK,iBACjB3B,mBAAoB,CAClB0B,IAAK,CAAExO,KAAM,aACb6N,KAAM,CAAE7N,KAAM,gBAIZwE,EAAUmI,EAAMvN,EAAI,CACxByN,WAAYvI,EAAKgF,cACjBwD,mBAAoB,CAClB0B,IAAK,CAAExO,KAAM,aACb6N,KAAM,CAAE7N,KAAM,gBAIZ0O,EAAW,IAAIvC,EAAS/M,EAAI,CAAEwB,QAAOC,WA6C3C,MAAO,CAAE6N,WAAU5C,UA5CD,WAChBwC,EAAgBI,EAASlC,YAAY,mBAAoB,CACvDgC,IAAK,CAACE,EAASjN,YAAY,iBAC3BoM,KAAM,CAACzO,EAAGgF,OAAOxD,MAAOxB,EAAGgF,OAAOvD,UAGpCyN,EAAgBI,EAASlC,YAAY,mBAAoB,CACvDgC,IAAK,CAACE,EAASjN,YAAY,iBAC3BoM,KAAM,CAACzO,EAAGgF,OAAOxD,MAAOxB,EAAGgF,OAAOvD,UAGpC+M,EAAWc,EAASlC,YAAY,cAAe,CAC7CgC,IAAK,CAACE,EAASjN,YAAY,iBAC3BoM,KAAM,CAACzO,EAAGgF,OAAOxD,MAAOxB,EAAGgF,OAAOvD,UAGpC2M,EAAekB,EAASlC,YAAY,gBAAiB,CACnDkB,gBAAiB,CAACgB,EAASjN,YAAY,oBACvCkM,gBAAiB,CAACe,EAASjN,YAAY,oBACvCmM,WAAY,CAACc,EAASjN,YAAY,eAClCoM,KAAM,CAACzO,EAAGgF,OAAOxD,MAAOxB,EAAGgF,OAAOvD,QAClC+H,KAAM,CAAC+F,YAAYC,MAAQ,OAG7Bd,EAAeY,EAASlC,YAAY,gBAAiB,CACnDwB,iBAAkB,CAACU,EAASjN,YAAY,iBACxCwM,gBAAiB,CAACS,EAASjN,YAAY,iBACvCoM,KAAM,CAACzO,EAAGgF,OAAOxD,MAAOxB,EAAGgF,OAAOvD,UAGpCqN,EAAeQ,EAASlC,YAAY,gBAAiB,CACnD4B,YAAa,CAACM,EAASjN,YAAY,iBACnC4M,YAAa,CAACK,EAASjN,YAAY,iBACnCoM,KAAM,CAACzO,EAAGgF,OAAOxD,MAAOxB,EAAGgF,OAAOvD,UAGpC2D,EAAQ,KAAM,CACZgK,IAAK,CAACE,EAASjN,YAAY,iBAC3BoM,KAAM,CAACzO,EAAGgF,OAAOxD,MAAOxB,EAAGgF,OAAOvD,UAEpC6N,EAASG,UElNEC,mLA1CJ,IACCC,EAAYtL,KAAKJ,MAAjB0L,QACR,OACErM,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAACoM,EAAD,CACE1I,KAAK,aACLD,OAAO,wBACP/B,KAAM,CAAEhF,eAAgByP,EAAQ,2BAElCrM,EAAAC,EAAAC,cAACoM,EAAD,CACE1I,KAAK,aACLD,OAAO,qCACP/B,KAAM,CACJgF,cAAeyF,EAAQ,qBACvBvF,WAAYuF,EAAQ,wCAEtB7H,QAAS,SAAA7D,GAAK,OAAIX,EAAAC,EAAAC,cAACqM,EAAe5L,IAClC8D,KAAM,kBAAM,QAEdzE,EAAAC,EAAAC,cAACoM,EAAD,CACE1I,KAAK,uBACLD,OAAO,2CACP/B,KAAM,CACJgF,cAAeyF,EAAQ,qBACvBtB,eAAgBsB,EAAQ,qCACxBhB,eAAgBgB,EAAQ,qCACxBZ,qBACEY,EAAQ,4CACVR,sBACEQ,EAAQ,6CACVN,iBAAkBM,EAAQ,wCAE5B7H,QAAS,SAAA7D,GAAK,OAAIX,EAAAC,EAAAC,cAACsM,EAAkB7L,IACrC8D,KAAM,SAAA9D,GAAK,OACTX,EAAAC,EAAAC,cAACsM,EAAD3L,OAAAwC,OAAA,GAAmB1C,EAAnB,CAA0BzC,MAAM,OAAOC,OAAO,qBAnCxCuE,8BDHlB,SAAS+J,IAEP,OAAIA,EAAUC,MAAcD,EAAUC,OACtCD,EAAUC,MAAQ,IAAIC,IACfF,EAAUC,OAIZ,YETDE,EAAiB,CACrB,WACA,WACA,kBACA,mBACA,aACA,SAEIC,EATW,CAAC,wBAUfC,IAAI,SAAAC,GAAI,OAAIH,EAAeE,IAAI,SAAAE,GAAO,SAAAzD,OAAOwD,GAAPxD,OAAcyD,EAAd,aACtCC,OAAO,SAACC,EAAKb,GAAN,OAAkBa,EAAI3D,OAAO8C,IAAU,IAE3Cc,EAAW,CACf,uBACA,oBACA,uCAEC5D,OAAOsD,GACPC,IAAI,SAAAM,GAAI,OACPC,MAAMD,GACHxH,KAAK,SAAA0H,GAAQ,OAAIA,EAASC,SAC1B3H,KAAK,SAAA4H,GAAY,OAAA3M,OAAA4M,EAAA,EAAA5M,CAAA,GAAQuM,EAAOI,QFZT,SAAAE,GAC5B,IAAMhB,EAAQD,IACViB,IAAYlE,GACdmE,SAASC,KAAKC,YAAYnB,EAAMoB,KAChCpB,EAAMoB,IAAI5L,MAAM6L,MAAQ,EACxBrB,EAAMoB,IAAI5L,MAAM8L,KAAO,KACvBxE,EAAQxD,sBAAsB,SAASiI,IACrCvB,EAAMwB,SACN1E,EAAQxD,sBAAsBiI,OAEtBP,GAAWlE,IACrBnD,qBAAqBmD,GACrBA,OAAQ2E,EACRR,SAASC,KAAKQ,YAAY1B,EAAMoB,MGdpCO,EAAe,GDiBN9I,QAAQ+I,IAAInB,GAChBvH,KAAK,SAAA2I,GAAS,OAAI1N,OAAOwC,OAAPP,MAAAjC,OAAM,CAAQ,IAAR0I,OAAA1I,OAAAgK,EAAA,EAAAhK,CAAe0N,OACvC3I,KAAK,SAAAyG,GACJ,IAAMmC,EAAQnC,EAAQ,kCAItB,OAHAxL,OAAO4N,KAAKpC,GAASqC,QAAQ,SAAA9K,GAC3ByI,EAAQzI,GAAQyI,EAAQzI,GAAM+K,QAAQ,wBAAyBH,KAE1DnC,ICtBCzG,KAAK,SAAAyG,GACjBnP,QAAQ+G,IAAIoI,GACZuC,IAASC,OAAO7O,EAAAC,EAAAC,cAAC4O,EAAD,CAAKzC,QAASA,IAAasB,SAASoB,eAAe","file":"static/js/main.a8c3f7d4.chunk.js","sourcesContent":["export const DEFAULT_VERTEX_SHADER = `\n#ifdef GL_ES\nprecision mediump float;\n#endif\nattribute vec2 a_position;\nattribute vec2 a_texcoord;\nvarying vec2 v_texcoord;\nvoid main() {\n    gl_Position = vec4(a_position, 0.0, 1.0);\n    v_texcoord = a_texcoord;\n}\n`;\n\nexport const createProgram = (gl, vertexShader, fragmentShader) => {\n  const program = gl.createProgram();\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  gl.linkProgram(program);\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n    console.error(\"Error linking program\", gl.getProgramInfoLog(program));\n  }\n  return program;\n};\n\nexport const createShader = (gl, type, src) => {\n  const s = gl.createShader(type);\n  gl.shaderSource(s, src);\n  gl.compileShader(s);\n  if (!gl.getShaderParameter(s, gl.COMPILE_STATUS)) {\n    console.error(\n      \"Could not compile shader\",\n      type,\n      src,\n      gl.getShaderInfoLog(s)\n    );\n  }\n  return s;\n};\n\nfunction randomInt(min, max) {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\nexport const randomImage = ({ width, height }) => {\n  let buffer = [];\n  for (let i = 0; i < width * height * 3; i++) {\n    buffer[i] = randomInt(0, 255);\n  }\n  return new Uint8Array(buffer);\n};\nexport const blankImage = ({ width, height }) => {\n  let buffer = new Uint8Array(3 * width * height);\n  buffer.fill(0, 0, buffer.length);\n  return buffer;\n};\n\nexport const loadImage = src => {\n  const img = new Image();\n  const promise = new Promise((resolve, reject) => {\n    img.onload = () => {\n      resolve(img);\n    };\n  });\n  img.src = src;\n  return promise;\n};\n\nexport const createTexture = (gl, textureUnit, image, { width, height }) => {\n  const texture = gl.createTexture();\n  gl.activeTexture(textureUnit);\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  gl.texImage2D(\n    gl.TEXTURE_2D,\n    0,\n    gl.RGB,\n    width,\n    height,\n    0,\n    gl.RGB,\n    gl.UNSIGNED_BYTE,\n    image\n  );\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n  gl.generateMipmap(gl.TEXTURE_2D);\n  return texture;\n};\n","import React from \"react\";\nimport ReactCSSTransitionGroup from \"react-addons-css-transition-group\";\n\nexport const FadeIn = ({ children }) => (\n  <ReactCSSTransitionGroup\n    transitionName=\"fade\"\n    transitionAppear={true}\n    transitionAppearTimeout={500}\n    transitionEnter={false}\n    transitionLeave={false}\n  >\n    {children}\n  </ReactCSSTransitionGroup>\n);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport webglCanvas from \"glslCanvas\";\n\nimport { DEFAULT_VERTEX_SHADER } from \"../utils\";\nimport { FadeIn } from \"./FadeIn\";\n\nexport class GlslCanvas extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.canvasRef = React.createRef();\n  }\n\n  initCanvas() {\n    const canvas = this.canvasRef.current;\n    const { fragmentShader } = this.props.code;\n    const { width, height } = this.props.display;\n    this.glslCanvas = new webglCanvas(canvas);\n    this.glslCanvas.load(fragmentShader);\n    canvas.style.width = width;\n    canvas.style.height = height;\n  }\n\n  componentDidMount() {\n    this.initCanvas();\n  }\n\n  render() {\n    const { width, height } = this.props.display;\n    const { fragmentShader, vertexShader } = this.props.code;\n    return (\n      <FadeIn>\n        <canvas\n          width={width}\n          height={height}\n          data-fragment={fragmentShader}\n          data-vertex={vertexShader}\n          ref={this.canvasRef}\n        />\n      </FadeIn>\n    );\n  }\n}\nGlslCanvas.propTypes = {\n  code: PropTypes.shape({\n    fragmentShader: PropTypes.string.isRequired,\n    vertexShader: PropTypes.string,\n    textures: PropTypes.arrayOf(PropTypes.string)\n  })\n};\nGlslCanvas.defaultProps = {\n  code: {\n    vertexShader: DEFAULT_VERTEX_SHADER,\n    textures: []\n  }\n};\n","import React from \"react\";\nimport classNames from \"classnames\";\n\nimport { GlslCanvas } from \"./GlslCanvas\";\n\nexport class GlslModal extends React.Component {\n  render() {\n    const { onClick } = this.props;\n    const { fullscreen } = this.props.display;\n    const display = {};\n    if (fullscreen === \"square\") {\n      display.width = window.innerHeight - 100 + \"px\";\n      display.height = window.innerHeight - 100 + \"px\";\n    } else if (fullscreen === \"fill\") {\n      display.width = \"100%\";\n      display.height = \"100%\";\n    }\n    const modalProps = Object.assign({}, this.props, { display });\n    const cssClasses = classNames(\"gallery-modal\", fullscreen);\n    return (\n      <div className={cssClasses} onClick={onClick}>\n        <GlslCanvas {...modalProps} />\n      </div>\n    );\n  }\n}\n","import React from \"react\";\n\nimport { FadeIn } from \"./FadeIn\";\n\nexport const Thumbnail = ({ imgSrc, name, width, height }) => (\n  <FadeIn>\n    <img src={imgSrc} alt={name} width={width} height={height} />\n  </FadeIn>\n);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { GlslCanvas } from \"./GlslCanvas\";\nimport { GlslModal } from \"./GlslModal\";\nimport { Thumbnail } from \"./Thumbnail\";\n\nexport class GalleryItem extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = { active: false };\n  }\n\n  handleClick = e => {\n    console.log(\"click\", this.state);\n    const { fullscreen } = this.state;\n    this.setState({ fullscreen: !fullscreen, active: false });\n  };\n\n  handleMouseEnter = e => {\n    console.log(\"enter\");\n    this.setState({ active: true });\n  };\n\n  handleMouseLeave = e => {\n    console.log(\"leave\");\n    this.setState({ active: false });\n  };\n\n  render() {\n    const { name, imgSrc, preview, full } = this.props;\n    const { width, height } = this.props.display;\n    const { active, fullscreen } = this.state;\n    const { author } = this.props.attribution;\n    const item = (\n      <div\n        className=\"gallery-item\"\n        width={width}\n        height={height}\n        onClick={this.handleClick}\n        onMouseEnter={this.handleMouseEnter}\n        onMouseLeave={this.handleMouseLeave}\n      >\n        {active ? (\n          preview(this.props)\n        ) : (\n          <Thumbnail\n            imgSrc={imgSrc}\n            name={name}\n            width={width}\n            height={height}\n          />\n        )}\n        <div className=\"credits\">\n          <p className=\"author label\">{author}</p>\n          <p className=\"title label\">{name}</p>\n        </div>\n      </div>\n    );\n    return fullscreen ? (\n      <span>\n        {full(this.props, this.handleClick)}\n        {item}\n      </span>\n    ) : (\n      item\n    );\n  }\n}\n\nGalleryItem.propTypes = {\n  name: PropTypes.string.isRequired,\n  imgSrc: PropTypes.string.isRequired,\n  display: PropTypes.shape({\n    width: PropTypes.string,\n    height: PropTypes.string,\n    fullscreen: PropTypes.oneOf([\"fill\", \"square\"])\n  }),\n  attribution: PropTypes.shape({\n    author: PropTypes.string,\n    date: PropTypes.instanceOf(Date),\n    credits: PropTypes.string,\n    link: PropTypes.string\n  })\n};\n\nGalleryItem.defaultProps = {\n  display: {\n    width: \"256px\",\n    height: \"256px\",\n    fullscreen: \"square\"\n  },\n  attribution: {},\n  preview: props => <GlslCanvas {...props} />,\n  full: (props, onClick) => <GlslModal {...props} onClick={onClick} />\n};\n","import React from \"react\";\nimport { createProgram, createShader, loadImage } from \"../../utils\";\n\nexport class GameOfLife extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.canvasRef = React.createRef();\n  }\n\n  componentDidMount() {\n    const { code } = this.props;\n    const canvas = this.canvasRef.current;\n    loadImage(\"frag/game-of-life/start-state.png\").then(startStateImg => {\n      const { animate } = createGameOfLife(canvas, code, startStateImg);\n      const step = () => {\n        console.time(\"step\");\n        animate();\n        this.animationFrameReq = requestAnimationFrame(step);\n        console.timeEnd(\"step\");\n      };\n      requestAnimationFrame(step);\n    });\n  }\n\n  componentWillUnmount() {\n    console.log(\"Clearing animation frame request \", this.animationFrameReq);\n    cancelAnimationFrame(this.animationFrameReq);\n  }\n\n  render() {\n    const { fragmentShader, vertexShader } = this.props.code;\n    return (\n      <canvas\n        width=\"64\"\n        height=\"64\"\n        data-fragment={fragmentShader}\n        data-vertex={vertexShader}\n        ref={this.canvasRef}\n        style={{ width: \"256px\", height: \"256px\", imageRendering: \"pixelated\" }}\n      />\n    );\n  }\n}\n\nconst createTexture = (gl, activeTexture, image) => {\n  const texture = gl.createTexture();\n  gl.activeTexture(activeTexture);\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n  gl.generateMipmap(gl.TEXTURE_2D);\n  return texture;\n};\n\nconst createGameOfLife = (canvasEl, code, startStateImg) => {\n  const gl = canvasEl.getContext(\"webgl\");\n\n  const vertexShader = createShader(\n    gl,\n    gl.VERTEX_SHADER,\n    \"attribute vec2 coord; void main(void) { gl_Position = vec4(coord, 0.0, 1.0); }\"\n  );\n  const fragShaderDisplay = createShader(\n    gl,\n    gl.FRAGMENT_SHADER,\n    code.displayShader\n  );\n  const fragShaderStepper = createShader(\n    gl,\n    gl.FRAGMENT_SHADER,\n    code.stepShader\n  );\n\n  const displayProg = createProgram(gl, vertexShader, fragShaderDisplay);\n  const stepperProg = createProgram(gl, vertexShader, fragShaderStepper);\n\n  gl.useProgram(stepperProg);\n\n  const stepperProgCoordLoc = gl.getAttribLocation(stepperProg, \"coord\");\n  const stepperProgPreviousStateLoc = gl.getUniformLocation(\n    stepperProg,\n    \"previousState\"\n  );\n\n  const displayProgStateLoc = gl.getUniformLocation(displayProg, \"tex\");\n  const displayProgSizeLoc = gl.getUniformLocation(displayProg, \"size\");\n  const vertexBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n  gl.bufferData(\n    gl.ARRAY_BUFFER,\n    new Float32Array([-1, -1, 1, -1, 1, 1, -1, 1]),\n    gl.STATIC_DRAW\n  );\n\n  // Note we must bind ARRAY_BUFFER before running vertexAttribPointer!\n  // This is confusing and deserves a blog post\n  // https://stackoverflow.com/questions/7617668/glvertexattribpointer-needed-everytime-glbindbuffer-is-called\n  gl.vertexAttribPointer(stepperProgCoordLoc, 2, gl.FLOAT, false, 0, 0);\n\n  const elementBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\n  gl.bufferData(\n    gl.ELEMENT_ARRAY_BUFFER,\n    new Uint8Array([0, 1, 2, 3]),\n    gl.STATIC_DRAW\n  );\n\n  const texture0 = createTexture(gl, gl.TEXTURE0, startStateImg);\n  const texture1 = createTexture(gl, gl.TEXTURE0 + 1, startStateImg);\n\n  const framebuffers = [gl.createFramebuffer(), gl.createFramebuffer()];\n\n  gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffers[0]);\n  gl.framebufferTexture2D(\n    gl.FRAMEBUFFER,\n    gl.COLOR_ATTACHMENT0,\n    gl.TEXTURE_2D,\n    texture0,\n    0\n  );\n\n  gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffers[1]);\n  gl.framebufferTexture2D(\n    gl.FRAMEBUFFER,\n    gl.COLOR_ATTACHMENT0,\n    gl.TEXTURE_2D,\n    texture1,\n    0\n  );\n\n  let nextStateIndex = 0;\n  const animate = function animate() {\n    const previousStateIndex = 1 - nextStateIndex;\n    gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffers[nextStateIndex]);\n    gl.useProgram(stepperProg);\n    gl.enableVertexAttribArray(stepperProgCoordLoc);\n    gl.uniform1i(stepperProgPreviousStateLoc, previousStateIndex);\n    gl.drawElements(gl.TRIANGLE_FAN, 4, gl.UNSIGNED_BYTE, 0);\n\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n    gl.useProgram(displayProg);\n    gl.uniform1i(displayProgStateLoc, nextStateIndex);\n    gl.uniform2f(displayProgSizeLoc, gl.canvas.width, gl.canvas.height);\n    gl.drawElements(gl.TRIANGLE_FAN, 4, gl.UNSIGNED_BYTE, 0);\n\n    nextStateIndex = previousStateIndex;\n  };\n  return { animate };\n};\n","import React from \"react\";\nimport _ from \"lodash\";\n\nimport {\n  createProgram,\n  createShader,\n  createTexture,\n  randomImage,\n  blankImage\n} from \"../../utils\";\n\nexport class ColorAutomata extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.canvasRef = React.createRef();\n  }\n\n  componentDidMount() {\n    const { code, width, height } = this.props;\n    const { nextFrame } = createColorAutomata(this.canvasRef.current, code, {\n      width,\n      height\n    });\n    const step = () => {\n      // console.time(\"step\");\n      nextFrame();\n      this.animationFrameReq = requestAnimationFrame(step);\n      // console.timeEnd(\"step\");\n    };\n    requestAnimationFrame(step);\n  }\n\n  componentWillUnmount() {\n    // console.log(\"Clearing animation frame request \", this.animationFrameReq);\n    cancelAnimationFrame(this.animationFrameReq);\n  }\n\n  render() {\n    const { width, height } = this.props;\n    return (\n      <canvas\n        width={width}\n        height={height}\n        ref={this.canvasRef}\n        style={{ width: `${width}px`, height: `${height}px` }}\n      />\n    );\n  }\n}\n\nColorAutomata.defaultProps = {\n  width: 256,\n  height: 256\n};\n\nclass Automata {\n  constructor(gl, { width, height }) {\n    this.active = 1;\n    this.frameBuffers = [];\n    const seed = randomImage({ width, height });\n    for (let idx = 0; idx < 7; idx++) {\n      const image = idx < 1 ? seed : blankImage({ width, height });\n      const texture = createTexture(gl, gl[`TEXTURE${idx}`], image, {\n        width,\n        height\n      });\n      const buffer = gl.createFramebuffer();\n      gl.bindFramebuffer(gl.FRAMEBUFFER, buffer);\n      gl.framebufferTexture2D(\n        gl.FRAMEBUFFER,\n        gl.COLOR_ATTACHMENT0,\n        gl.TEXTURE_2D,\n        texture,\n        0\n      );\n      this.frameBuffers.push({ textureUnit: idx, frameBuffer: buffer });\n    }\n  }\n\n  swap() {\n    this.active = 1 - this.active;\n  }\n\n  textureUnit(id) {\n    switch (id) {\n      case \"prevPosition\":\n        return this.active ? 0 : 1;\n      case \"prevVelocity\":\n        return 2;\n      case \"nextPosition\":\n        return this.active ? 1 : 0;\n      case \"nextVelocity\":\n        return 3;\n      case \"positionAverage\":\n        return 4;\n      case \"velocityAverage\":\n        return 5;\n      case \"separation\":\n        return 6;\n      default:\n        throw new Error(\"id not recognized\");\n    }\n  }\n\n  frameBuffer(id) {\n    return this.frameBuffers[this.textureUnit(id)].frameBuffer;\n  }\n}\n\nconst createVertexShader = gl => {\n  return createShader(\n    gl,\n    gl.VERTEX_SHADER,\n    \"attribute vec2 coord; void main(void) { gl_Position = vec4(coord, 0.0, 1.0); }\"\n  );\n};\n\nconst gpgpu = (gl, options) => {\n  const { shaderCode, uniformDefinitions } = options;\n  const vertexShader = createVertexShader(gl);\n  const fragmentShader = createShader(gl, gl.FRAGMENT_SHADER, shaderCode);\n  const program = createProgram(gl, vertexShader, fragmentShader);\n  const coordLoc = gl.getAttribLocation(program, \"coord\");\n\n  const vertexBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n  gl.bufferData(\n    gl.ARRAY_BUFFER,\n    new Float32Array([-1, -1, 1, -1, 1, 1, -1, 1]),\n    gl.STATIC_DRAW\n  );\n\n  // Note we must bind ARRAY_BUFFER before running vertexAttribPointer!\n  // This is confusing and deserves a blog post\n  // https://stackoverflow.com/questions/7617668/glvertexattribpointer-needed-everytime-glbindbuffer-is-called\n  gl.vertexAttribPointer(coordLoc, 2, gl.FLOAT, false, 0, 0);\n\n  const elementBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\n  gl.bufferData(\n    gl.ELEMENT_ARRAY_BUFFER,\n    new Uint8Array([0, 1, 2, 3]),\n    gl.STATIC_DRAW\n  );\n\n  const mappedUniforms = _.mapValues(uniformDefinitions, (props, name) =>\n    Object.assign(props, { loc: gl.getUniformLocation(program, name) })\n  );\n\n  return (frameBuffer, uniforms) => {\n    gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\n    gl.useProgram(program);\n    gl.enableVertexAttribArray(coordLoc);\n    _.forOwn(mappedUniforms, (props, name) => {\n      gl[props.type](props.loc, ...uniforms[name]);\n    });\n    gl.drawElements(gl.TRIANGLE_FAN, 4, gl.UNSIGNED_BYTE, 0);\n  };\n};\n\nconst createColorAutomata = (canvasEl, code, { width, height }) => {\n  const gl = canvasEl.getContext(\"webgl\");\n\n  const updateVelocity = gpgpu(gl, {\n    shaderCode: code.velocityShader,\n    uniformDefinitions: {\n      velocityAverage: { type: \"uniform1i\" },\n      positionAverage: { type: \"uniform1i\" },\n      separation: { type: \"uniform1i\" },\n      size: { type: \"uniform2f\" },\n      time: { type: \"uniform1f\" }\n    }\n  });\n\n  const updatePosition = gpgpu(gl, {\n    shaderCode: code.positionShader,\n    uniformDefinitions: {\n      previousPosition: { type: \"uniform1i\" },\n      currentVelocity: { type: \"uniform1i\" },\n      size: { type: \"uniform2f\" }\n    }\n  });\n\n  const invertVelocity = gpgpu(gl, {\n    shaderCode: code.invertVelocityShader,\n    uniformDefinitions: {\n      positionTex: { type: \"uniform1i\" },\n      velocityTex: { type: \"uniform1i\" },\n      size: { type: \"uniform2f\" }\n    }\n  });\n\n  const neighborAverage = gpgpu(gl, {\n    shaderCode: code.neighborAverageShader,\n    uniformDefinitions: {\n      tex: { type: \"uniform1i\" },\n      size: { type: \"uniform2f\" }\n    }\n  });\n\n  const separation = gpgpu(gl, {\n    shaderCode: code.separationShader,\n    uniformDefinitions: {\n      tex: { type: \"uniform1i\" },\n      size: { type: \"uniform2f\" }\n    }\n  });\n\n  const display = gpgpu(gl, {\n    shaderCode: code.displayShader,\n    uniformDefinitions: {\n      tex: { type: \"uniform1i\" },\n      size: { type: \"uniform2f\" }\n    }\n  });\n\n  const automata = new Automata(gl, { width, height });\n  const nextFrame = function() {\n    neighborAverage(automata.frameBuffer(\"positionAverage\"), {\n      tex: [automata.textureUnit(\"prevPosition\")],\n      size: [gl.canvas.width, gl.canvas.height]\n    });\n\n    neighborAverage(automata.frameBuffer(\"velocityAverage\"), {\n      tex: [automata.textureUnit(\"prevVelocity\")],\n      size: [gl.canvas.width, gl.canvas.height]\n    });\n\n    separation(automata.frameBuffer(\"separation\"), {\n      tex: [automata.textureUnit(\"prevPosition\")],\n      size: [gl.canvas.width, gl.canvas.height]\n    });\n\n    updateVelocity(automata.frameBuffer(\"nextVelocity\"), {\n      velocityAverage: [automata.textureUnit(\"velocityAverage\")],\n      positionAverage: [automata.textureUnit(\"positionAverage\")],\n      separation: [automata.textureUnit(\"separation\")],\n      size: [gl.canvas.width, gl.canvas.height],\n      time: [performance.now() / 1000]\n    });\n\n    updatePosition(automata.frameBuffer(\"nextPosition\"), {\n      previousPosition: [automata.textureUnit(\"prevPosition\")],\n      currentVelocity: [automata.textureUnit(\"nextVelocity\")],\n      size: [gl.canvas.width, gl.canvas.height]\n    });\n\n    invertVelocity(automata.frameBuffer(\"prevVelocity\"), {\n      positionTex: [automata.textureUnit(\"nextPosition\")],\n      velocityTex: [automata.textureUnit(\"nextVelocity\")],\n      size: [gl.canvas.width, gl.canvas.height]\n    });\n\n    display(null, {\n      tex: [automata.textureUnit(\"nextPosition\")],\n      size: [gl.canvas.width, gl.canvas.height]\n    });\n    automata.swap();\n\n    // display(null, { });\n  };\n  return { automata, nextFrame };\n};\n","import Stats from \"stats.js\";\n\nfunction makeStats() {\n  // poor man's run once\n  if (makeStats.stats) return makeStats.stats;\n  makeStats.stats = new Stats();\n  return makeStats.stats;\n}\n\nlet reqId;\nexport const showFpsCounter = enabled => {\n  const stats = makeStats();\n  if (enabled && !reqId) {\n    document.body.appendChild(stats.dom);\n    stats.dom.style.right = 0;\n    stats.dom.style.left = null;\n    reqId = requestAnimationFrame(function loop() {\n      stats.update();\n      reqId = requestAnimationFrame(loop);\n    });\n  } else if (!enabled && reqId) {\n    cancelAnimationFrame(reqId);\n    reqId = undefined;\n    document.body.removeChild(stats.dom);\n  }\n};\n","import React, { Component } from \"react\";\nimport { GalleryItem } from \"./components/GalleryItem\";\nimport { GameOfLife } from \"./components/gallery/GameOfLife\";\nimport { ColorAutomata } from \"./components/gallery/ColorAutomata\";\n\nclass App extends Component {\n  render() {\n    const { shaders } = this.props;\n    return (\n      <div>\n        <GalleryItem\n          name=\"256 colors\"\n          imgSrc=\"./frag/256-colors.png\"\n          code={{ fragmentShader: shaders[\"frag/256-colors.frag\"] }}\n        />\n        <GalleryItem\n          name=\"Glider gun\"\n          imgSrc=\"./frag/game-of-life/glider-gun.png\"\n          code={{\n            displayShader: shaders[\"frag/display.frag\"],\n            stepShader: shaders[\"frag/game-of-life/game-of-life.frag\"]\n          }}\n          preview={props => <GameOfLife {...props} />}\n          full={() => null}\n        />\n        <GalleryItem\n          name=\"Color Automata (WIP)\"\n          imgSrc=\"./frag/color-automata/color-automata.png\"\n          code={{\n            displayShader: shaders[\"frag/display.frag\"],\n            velocityShader: shaders[\"frag/color-automata/velocity.frag\"],\n            positionShader: shaders[\"frag/color-automata/position.frag\"],\n            invertVelocityShader:\n              shaders[\"frag/color-automata/invert-velocity.frag\"],\n            neighborAverageShader:\n              shaders[\"frag/color-automata/neighbor-average.frag\"],\n            separationShader: shaders[\"frag/color-automata/separation.frag\"]\n          }}\n          preview={props => <ColorAutomata {...props} />}\n          full={props => (\n            <ColorAutomata {...props} width=\"1024\" height=\"1024\" />\n          )}\n        />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","const automata = [\"frag/color-automata/\"];\nconst shaderVariants = [\n  \"velocity\",\n  \"position\",\n  \"invert-velocity\",\n  \"neighbor-average\",\n  \"separation\",\n  \"utils\"\n];\nconst automataShaders = automata\n  .map(path => shaderVariants.map(variant => `${path}${variant}.frag`))\n  .reduce((acc, shaders) => acc.concat(shaders), []);\n\nconst promises = [\n  \"frag/256-colors.frag\",\n  \"frag/display.frag\",\n  \"frag/game-of-life/game-of-life.frag\"\n]\n  .concat(automataShaders)\n  .map(frag =>\n    fetch(frag)\n      .then(response => response.text())\n      .then(responseText => ({ [frag]: responseText }))\n  );\n\nexport const loadShaders = function loadShaders() {\n  return Promise.all(promises)\n    .then(responses => Object.assign({}, ...responses))\n    .then(shaders => {\n      const utils = shaders[\"frag/color-automata/utils.frag\"];\n      Object.keys(shaders).forEach(name => {\n        shaders[name] = shaders[name].replace(\"// include utils.frag\", utils);\n      });\n      return shaders;\n    });\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport \"./index.css\";\n\nimport App from \"./App\";\nimport { showFpsCounter } from \"./stats\";\nimport { loadShaders } from \"./loader\";\n\nshowFpsCounter(true);\n\nloadShaders().then(shaders => {\n  console.log(shaders);\n  ReactDOM.render(<App shaders={shaders} />, document.getElementById(\"root\"));\n});\n"],"sourceRoot":""}