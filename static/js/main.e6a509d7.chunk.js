(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,r){e.exports=r(47)},30:function(e,t,r){},47:function(e,t,r){"use strict";r.r(t);var a=r(0),i=r.n(a),n=r(10),o=r.n(n),c=(r(30),r(1)),s=r(2),u=r(4),f=r(3),h=r(5),l=r(16),m=r.n(l),d=function(e,t,r){var a=e.createProgram();return e.attachShader(a,t),e.attachShader(a,r),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)||console.error("Error linking program",e.getProgramInfoLog(a)),a},p=function(e,t,r){var a=e.createShader(t);return e.shaderSource(a,r),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)||console.error("Could not compile shader",t,r,e.getShaderInfoLog(a)),a};var v=function(e){for(var t,r,a=e.width,i=e.height,n=[],o=0;o<a*i*3;o++)n[o]=(t=0,r=255,Math.floor(Math.random()*(r-t+1))+t);return new Uint8Array(n)},E=function(e){var t=e.width,r=e.height,a=new Uint8Array(3*t*r);return a.fill(128,0,a.length),a},g=function(e,t,r,a){var i=a.width,n=a.height,o=e.createTexture();return e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGB,i,n,0,e.RGB,e.UNSIGNED_BYTE,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),o},T=r(17),R=r.n(T),y=function(e){var t=e.children;return i.a.createElement(R.a,{transitionName:"fade",transitionAppear:!0,transitionAppearTimeout:500,transitionEnter:!1,transitionLeave:!1},t)},A=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(f.a)(t).call(this,e))).canvasRef=i.a.createRef(),r}return Object(h.a)(t,e),Object(s.a)(t,[{key:"initCanvas",value:function(){var e=this.canvasRef.current,t=this.props.code.fragmentShader,r=this.props.display,a=r.width,i=r.height;this.glslCanvas=new m.a(e),this.glslCanvas.load(t),e.style.width=a,e.style.height=i}},{key:"componentDidMount",value:function(){this.initCanvas()}},{key:"render",value:function(){var e=this.props.display,t=e.width,r=e.height,a=this.props.code,n=a.fragmentShader,o=a.vertexShader;return i.a.createElement(y,null,i.a.createElement("canvas",{width:t,height:r,"data-fragment":n,"data-vertex":o,ref:this.canvasRef}))}}]),t}(i.a.Component);A.defaultProps={code:{vertexShader:"\n#ifdef GL_ES\nprecision mediump float;\n#endif\nattribute vec2 a_position;\nattribute vec2 a_texcoord;\nvarying vec2 v_texcoord;\nvoid main() {\n    gl_Position = vec4(a_position, 0.0, 1.0);\n    v_texcoord = a_texcoord;\n}\n",textures:[]}};var b=r(18),F=r.n(b),x=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.onClick,t=this.props.display.fullscreen,r={};"square"===t?(r.width=window.innerHeight-100+"px",r.height=window.innerHeight-100+"px"):"fill"===t&&(r.width="100%",r.height="100%");var a=Object.assign({},this.props,{display:r}),n=F()("gallery-modal",t);return i.a.createElement("div",{className:n,onClick:e},i.a.createElement(A,a))}}]),t}(i.a.Component),_=function(e){var t=e.imgSrc,r=e.name,a=e.width,n=e.height;return i.a.createElement(y,null,i.a.createElement("img",{src:t,alt:r,width:a,height:n}))};(function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(f.a)(t).call(this,e))).handleClick=function(e){console.log("click",r.state);var t=r.state.fullscreen;r.setState({fullscreen:!t,active:!1})},r.handleMouseEnter=function(e){console.log("enter"),r.setState({active:!0})},r.handleMouseLeave=function(e){console.log("leave"),r.setState({active:!1})},r.state={active:!1},r}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,r=e.imgSrc,a=e.preview,n=e.full,o=this.props.display,c=o.width,s=o.height,u=this.state,f=u.active,h=u.fullscreen,l=this.props.attribution.author,m=i.a.createElement("div",{className:"gallery-item",width:c,height:s,onClick:this.handleClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},f?a(this.props):i.a.createElement(_,{imgSrc:r,name:t,width:c,height:s}),i.a.createElement("div",{className:"credits"},i.a.createElement("p",{className:"author label"},l),i.a.createElement("p",{className:"title label"},t)));return h?i.a.createElement("span",null,n(this.props,this.handleClick),m):m}}]),t}(i.a.Component)).defaultProps={display:{width:"256px",height:"256px",fullscreen:"square"},attribution:{},preview:function(e){return i.a.createElement(A,e)},full:function(e,t){return i.a.createElement(x,Object.assign({},e,{onClick:t}))}};i.a.Component;var w=function(e,t,r){var a=e.createTexture();return e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,e.RGB,e.RGB,e.UNSIGNED_BYTE,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.generateMipmap(e.TEXTURE_2D),a},U=function(e,t,r){var a=e.getContext("webgl"),i=p(a,a.VERTEX_SHADER,"attribute vec2 coord; void main(void) { gl_Position = vec4(coord, 0.0, 1.0); }"),n=p(a,a.FRAGMENT_SHADER,t.displayShader),o=p(a,a.FRAGMENT_SHADER,t.stepShader),c=d(a,i,n),s=d(a,i,o);a.useProgram(s);var u=a.getAttribLocation(s,"coord"),f=a.getUniformLocation(s,"previousState"),h=a.getUniformLocation(c,"tex"),l=a.getUniformLocation(c,"size"),m=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,m),a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,1,1,-1,1]),a.STATIC_DRAW),a.vertexAttribPointer(u,2,a.FLOAT,!1,0,0);var v=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,v),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint8Array([0,1,2,3]),a.STATIC_DRAW);var E=w(a,a.TEXTURE0,r),g=w(a,a.TEXTURE0+1,r),T=[a.createFramebuffer(),a.createFramebuffer()];a.bindFramebuffer(a.FRAMEBUFFER,T[0]),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,E,0),a.bindFramebuffer(a.FRAMEBUFFER,T[1]),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,g,0);var R=0;return{animate:function(){var e=1-R;a.bindFramebuffer(a.FRAMEBUFFER,T[R]),a.useProgram(s),a.enableVertexAttribArray(u),a.uniform1i(f,e),a.drawElements(a.TRIANGLE_FAN,4,a.UNSIGNED_BYTE,0),a.bindFramebuffer(a.FRAMEBUFFER,null),a.useProgram(c),a.uniform1i(h,R),a.uniform2f(l,a.canvas.width,a.canvas.height),a.drawElements(a.TRIANGLE_FAN,4,a.UNSIGNED_BYTE,0),R=e}}},S=r(7),B=r(8),D=r.n(B),O=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(f.a)(t).call(this,e))).canvasRef=i.a.createRef(),r}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.code,r=M(this.canvasRef.current,t,this.props).nextFrame;requestAnimationFrame(function t(){r(),e.animationFrameReq=requestAnimationFrame(t)})}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.animationFrameReq)}},{key:"render",value:function(){var e=this.props,t=e.width,r=e.height;return i.a.createElement("canvas",{width:t,height:r,ref:this.canvasRef,style:{width:"".concat(t,"px"),height:"".concat(r,"px")}})}}]),t}(i.a.Component);O.defaultProps={width:256,height:256,velocityEase:.33,invertBounce:1,cohesionWeight:.5,alignmentWeight:.5,separationWeight:4,separationThreshold:.5,velocityWeight:1};var C,P=function(){function e(t,r){var a=r.width,i=r.height;Object(c.a)(this,e),this.active=1,this.frameBuffers=[];for(var n=v({width:a,height:i}),o=0;o<7;o++){var s=o<=1?n:E({width:a,height:i}),u=g(t,t["TEXTURE".concat(o)],s,{width:a,height:i}),f=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,f),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,u,0),this.frameBuffers.push({textureUnit:o,frameBuffer:f})}}return Object(s.a)(e,[{key:"swap",value:function(){this.active=1-this.active}},{key:"textureUnit",value:function(e){switch(e){case"prevPosition":return this.active?0:1;case"nextPosition":return this.active?1:0;case"prevVelocity":return 2;case"nextVelocity":return 3;case"cohesion":return 4;case"alignment":return 5;case"separation":return 6;default:throw new Error("id not recognized")}}},{key:"frameBuffer",value:function(e){return this.frameBuffers[this.textureUnit(e)].frameBuffer}}]),e}(),N=function(e,t){var r=t.shaderCode,a=t.uniformDefinitions,i=function(e){return p(e,e.VERTEX_SHADER,"attribute vec2 coord; void main(void) { gl_Position = vec4(coord, 0.0, 1.0); }")}(e),n=p(e,e.FRAGMENT_SHADER,r),o=d(e,i,n),c=e.getAttribLocation(o,"coord"),s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.STATIC_DRAW),e.vertexAttribPointer(c,2,e.FLOAT,!1,0,0);var u=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,u),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint8Array([0,1,2,3]),e.STATIC_DRAW);var f=D.a.mapValues(a,function(t,r){return Object.assign(t,{loc:e.getUniformLocation(o,r)})});return function(t,r){e.bindFramebuffer(e.FRAMEBUFFER,t),e.useProgram(o),e.enableVertexAttribArray(c),D.a.forOwn(f,function(t,a){var i;e[t.type].apply(e,[t.loc].concat(Object(S.a)((i=r[a],D.a.isArray(i)?i:[i]))))}),e.drawElements(e.TRIANGLE_FAN,4,e.UNSIGNED_BYTE,0)}},M=function(e,t,r){var a=e.getContext("webgl"),i=r.width,n=r.height,o=N(a,{shaderCode:t.velocityShader,uniformDefinitions:{previousVelocity:{type:"uniform1i"},alignment:{type:"uniform1i"},cohesion:{type:"uniform1i"},separation:{type:"uniform1i"},size:{type:"uniform2f"},velocityWeight:{type:"uniform1f"},alignmentWeight:{type:"uniform1f"},cohesionWeight:{type:"uniform1f"},separationWeight:{type:"uniform1f"},velocityEase:{type:"uniform1f"}}}),c=N(a,{shaderCode:t.positionShader,uniformDefinitions:{previousPosition:{type:"uniform1i"},currentVelocity:{type:"uniform1i"},size:{type:"uniform2f"}}}),s=N(a,{shaderCode:t.invertVelocityShader,uniformDefinitions:{positionTex:{type:"uniform1i"},velocityTex:{type:"uniform1i"},size:{type:"uniform2f"},invertBounce:{type:"uniform1f"}}}),u=N(a,{shaderCode:t.neighborAverageShader,uniformDefinitions:{tex:{type:"uniform1i"},size:{type:"uniform2f"}}}),f=N(a,{shaderCode:t.separationShader,uniformDefinitions:{tex:{type:"uniform1i"},size:{type:"uniform2f"},separationThreshold:{type:"uniform1f"}}}),h=N(a,{shaderCode:t.displayShader,uniformDefinitions:{tex:{type:"uniform1i"},size:{type:"uniform2f"}}}),l=new P(a,{width:i,height:n}),m=r.invertBounce,d=r.separationThreshold,p=r.alignmentWeight,v=r.cohesionWeight,E=r.separationWeight,g=r.velocityEase,T=r.velocityWeight;console.log(r);return{automata:l,nextFrame:function(){s(l.frameBuffer("prevVelocity"),{positionTex:[l.textureUnit("prevPosition")],velocityTex:[l.textureUnit("nextVelocity")],size:[a.canvas.width,a.canvas.height],invertBounce:m}),u(l.frameBuffer("cohesion"),{tex:[l.textureUnit("prevPosition")],size:[a.canvas.width,a.canvas.height]}),u(l.frameBuffer("alignment"),{tex:[l.textureUnit("prevVelocity")],size:[a.canvas.width,a.canvas.height]}),f(l.frameBuffer("separation"),{tex:[l.textureUnit("prevPosition")],size:[a.canvas.width,a.canvas.height],separationThreshold:d}),o(l.frameBuffer("nextVelocity"),{previousVelocity:[l.textureUnit("prevVelocity")],alignment:[l.textureUnit("alignment")],cohesion:[l.textureUnit("cohesion")],separation:[l.textureUnit("separation")],size:[a.canvas.width,a.canvas.height],time:[performance.now()/1e3],alignmentWeight:p,separationWeight:E,cohesionWeight:v,velocityEase:g,velocityWeight:T}),c(l.frameBuffer("nextPosition"),{previousPosition:[l.textureUnit("prevPosition")],currentVelocity:[l.textureUnit("nextVelocity")],size:[a.canvas.width,a.canvas.height]}),h(null,{tex:[l.textureUnit("nextPosition")],size:[a.canvas.width,a.canvas.height]}),l.swap()}}},j=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.shaders;return i.a.createElement(O,{name:"Color Automata (WIP)",imgSrc:"./frag/color-automata/color-automata.png",code:{displayShader:e["frag/display.frag"],velocityShader:e["frag/color-automata/velocity.frag"],positionShader:e["frag/color-automata/position.frag"],invertVelocityShader:e["frag/color-automata/invert-velocity.frag"],neighborAverageShader:e["frag/color-automata/neighbor-average.frag"],separationShader:e["frag/color-automata/separation.frag"]},width:window.innerWidth,height:window.innerHeight})}}]),t}(a.Component),L=r(19),I=r.n(L);function k(){return k.stats?k.stats:(k.stats=new I.a,k.stats)}var W=r(20),X=["velocity","position","invert-velocity","neighbor-average","separation","utils"],G=["frag/color-automata/"].map(function(e){return X.map(function(t){return"".concat(e).concat(t,".frag")})}).reduce(function(e,t){return e.concat(t)},[]),V=["frag/256-colors.frag","frag/display.frag","frag/game-of-life/game-of-life.frag"].concat(G).map(function(e){return fetch(e).then(function(e){return e.text()}).then(function(t){return Object(W.a)({},e,t)})});!function(e){var t=k();e&&!C?(document.body.appendChild(t.dom),t.dom.style.right=0,t.dom.style.left=null,C=requestAnimationFrame(function e(){t.update(),C=requestAnimationFrame(e)})):!e&&C&&(cancelAnimationFrame(C),C=void 0,document.body.removeChild(t.dom))}(!0),Promise.all(V).then(function(e){return Object.assign.apply(Object,[{}].concat(Object(S.a)(e)))}).then(function(e){var t=e["frag/color-automata/utils.frag"];return Object.keys(e).forEach(function(r){e[r]=e[r].replace("// include utils.frag",t)}),e}).then(function(e){console.log(e),o.a.render(i.a.createElement(j,{shaders:e}),document.getElementById("root"))})}},[[21,2,1]]]);
//# sourceMappingURL=main.e6a509d7.chunk.js.map